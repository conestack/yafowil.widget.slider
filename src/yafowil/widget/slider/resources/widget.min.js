!function(e,t){"use strict";class s{static initialize(e){t(".yafowil_slider",e).each((function(){new s(t(this))}))}constructor(e){this.elem=e,this.options=this.elem.data(),this.bind_options();let s=this.slider_handle_dim=20;this.input=t("input.slider_value",this.elem),this.slider_elem=t("div.slider",this.elem);let i=this.slider_handle_elem=t(`\n            <div class="slider-handle" \n                style="width:${s}px; height:${s}px"/>\n        `),l=this.slider_handle_elem_end=t(`\n            <div class="slider-handle-end"\n                style="width:${s}px; height:${s}px"/>\n        `),o=this.slider_value_track=t('\n            <div class="slider-value-track" />\n        '),n=t('\n            <div class="slider-bg" />\n        ');this.slider_elem.append(n).append(o).append(i),this.handle_singletouch=this.handle_singletouch.bind(this),this.handle_start=this.mousedown_touchstart.bind(this),this.handle_range=this.handle_range.bind(this),!0===this.options.range?(this.slider_elem.append(l),this.slider_handle_elem.on("mousedown touchstart",this.handle_range),this.slider_handle_elem_end.on("mousedown touchstart",this.handle_range),this.slider_elem.on("mousedown touchstart",this.handle_singletouch)):(this.slider_handle_elem.on("mousedown touchstart",this.handle_start),this.slider_elem.on("mousedown touchstart",this.handle_singletouch)),this.init_position()}bind_options(){let e={};!0===this.options.range?(e.lower_display=t("span.lower_value",this.elem),e.upper_display=t("span.upper_value",this.elem),e.lower_value=t("input.lower_value",this.elem),e.upper_value=t("input.upper_value",this.elem),this.options.values=[e.lower_value.val(),e.upper_value.val()]):(e.display=t("span.slider_value",this.elem),e.value=t("input.slider_value",this.elem),this.options.value=e.value.val()),this.elem.data("slider_elements",e)}init_position(){let e=this.options;if(e.min=e.min??0,e.max=e.max??100,"vertical"===e.orientation?(this.slider_elem.addClass("slider-vertical"),this.slider_dim=this.slider_elem.height(),this.offset=this.slider_elem.offset().top):(this.slider_dim=this.elem.width(),this.offset=this.elem.offset().left),!0===e.range){let t=[this.transform(e.values[0],"display"),this.transform(e.values[1],"display")];this.set_position(t)}else if(e.value){let t=this.transform(e.value,"display");this.set_position(t)}"max"===e.range&&("vertical"===e.orientation?this.slider_value_track.css("bottom",0).css("top","unset"):this.slider_value_track.css("right",0))}handle_singletouch(e){let t,s="vertical"===this.options.orientation;t="mousedown"===e.type?s?e.pageY:e.pageX:s?e.touches[0].pageY:e.touches[0].pageX;let i=t-this.offset,l=this.transform(i,"range");if(this.options.step&&(l=this.transform(l,"step"),i=this.transform(l,"display")),!0===this.options.range){let e=s?"top":"left",t=[parseInt(this.slider_handle_elem.css(e)),parseInt(this.slider_handle_elem_end.css(e))],o=i<t[0]||i<(t[0]+t[1])/2,n=o?".lower_value":".upper_value";t=o?[i,t[1]]:[t[0],i],this.set_position(t),this.set_values(l,n)}else this.set_position(i),this.set_values(l)}mousedown_touchstart(e){e.preventDefault(),e.stopPropagation();let s="vertical"===this.options.orientation,i=this.options.step,l=function(e){let n;e.preventDefault(),e.stopPropagation(),o?(n=(s?e.pageY:e.pageX)-this.offset,t(window).on("mouseup",(()=>{this.elem.off("mousemove")}))):(n=(s?e.touches[0].pageY:e.touches[0].pageX)-this.offset,document.addEventListener("touchend",(()=>{document.removeEventListener("touchmove",l)}),!1));let a=this.prevent_overflow(n),h=this.transform(a,"range");i&&(h=this.transform(h,"step"),a=this.transform(h,"display"));this.set_position(a),this.set_values(h)}.bind(this),o="mousedown"===e.type;o?this.elem.off("mousemove").on("mousemove",l):document.addEventListener("touchmove",l,{passive:!1})}handle_range(e){e.preventDefault(),e.stopPropagation();let s=e.target,i="vertical"===this.options.orientation,l=i?"top":"left",o=[this.slider_handle_elem,this.slider_handle_elem_end],n=function(e){let t;e.preventDefault(),e.stopPropagation(),t=a?i?e.pageY:e.pageX:i?e.touches[0].pageY:e.touches[0].pageX;t=this.prevent_overflow(t-this.offset);let n=this.transform(t,"range"),h=[parseInt(o[0].css(l)),parseInt(o[1].css(l))];if(s===o[0][0]){if(t>=h[1])return;h[0]=t,this.set_values(n,".lower_value")}else if(s===o[1][0]){if(t<=h[0])return;h[1]=t,this.set_values(n,".upper_value")}this.set_position(h)}.bind(this),a="mousedown"===e.type;a?(t(this.elem).off("mousemove").on("mousemove",n),t(window).on("mouseup",(()=>{this.elem.off("mousemove")}))):(document.addEventListener("touchmove",n,{passive:!1}),document.addEventListener("touchend",(()=>{document.removeEventListener("touchmove",n)}),!1))}prevent_overflow(e){return e>=this.slider_dim?e=this.slider_dim:e<=0&&(e=0),e}set_position(e){let t="vertical"===this.options.orientation,s=this.options.range,i=this.slider_value_track,l=this.slider_handle_elem,o=this.slider_handle_elem_end;if(t)if("max"===s)i.css("height",this.slider_dim-e),l.css("top",e+"px");else if(!0===s){l.css("top",e[0]),o.css("top",e[1]);let t=e[1]-e[0];i.css("height",t).css("top",`${e[0]}px`)}else i.css("height",e),l.css("top",e+"px");else if("max"===s)i.css("width",this.slider_dim-e),l.css("left",e+"px");else if(!0===s){l.css("left",e[0]),o.css("left",e[1]);let t=e[1]-e[0];i.css("width",t).css("left",`${e[0]}px`)}else i.css("width",e),l.css("left",e+"px")}set_values(e,s){!0===this.options.range?(t(`span${s}`).text(e),t(`input${s}`).attr("value",e)):(t("span.slider_value",this.elem).text(e),this.input.attr("value",e))}transform(e,t){let s=this.options.min,i=this.options.max,l=this.options.step;return"step"===t?e=e>i-l/2?i:l*parseInt(e/l):"display"===t?e=parseInt(this.slider_dim*((e-s)/(i-s))):"range"===t&&(e=parseInt((i-s)*(e/this.slider_dim)+s)),e}}t((function(){void 0!==window.ts?ts.ajax.register(s.initialize,!0):s.initialize()})),e.Slider=s,Object.defineProperty(e,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.slider=e}({},jQuery);
