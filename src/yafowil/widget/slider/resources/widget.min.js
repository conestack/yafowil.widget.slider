!function(e,t){"use strict";class s{static initialize(e){t(".yafowil_slider",e).each((function(){new s(t(this))}))}constructor(e){if(this.elem=e,this.options=this.elem.data(),this.init_options(),this.slider_handle_dim=20,this.input=t("input.slider_value",this.elem),this.slider_elem=t("div.slider",this.elem),this.slider_value_track=t("<div></div>").addClass("slider-value-track"),this.slider_elem.append(t("<div></div>").addClass("slider-bg")).append(this.slider_value_track),this.handles=[],this.range_true){let e=new i(this.slider_elem,this.options,this.options.values[0]),t=new i(this.slider_elem,this.options,this.options.values[1]);this.handles.push(e),this.handles.push(t)}else{let e=new i(this.slider_elem,this.options);this.handles.push(e)}this.handle_singletouch=this.handle_singletouch.bind(this),this.slider_elem.on("mousedown touchstart",this.handle_singletouch),this.init_position(),this.set_value_track(),this.slider_elem.on("drag",this.set_value_track.bind(this)),this.slider_elem.on("drag",this.set_values.bind(this)),this.resize_handle=this.resize_handle.bind(this),t(window).on("resize",this.resize_handle)}get vertical(){return"vertical"===this.options.orientation}get dim(){return this.vertical?"height":"width"}get dir(){return this.vertical?"top":"left"}get range_max(){return"max"===this.options.range}get range_true(){return!0===this.options.range}get offset(){return this.vertical?this.slider_elem.offset().top:this.elem.offset().left}get slider_dim(){return this.vertical?this.slider_elem.height():this.elem.width()}set_value_track(){let e=this.handles[0].value_screen;if(this.range_true){let t=this.handles[1].value_screen-this.handles[0].value_screen;this.slider_value_track.css(`${this.dim}`,t).css(`${this.dir}`,`${e}px`)}else this.range_max?this.slider_value_track.css(`${this.dim}`,this.slider_dim-e):this.slider_value_track.css(`${this.dim}`,e)}init_options(){let e={};this.range_true?(e.lower_display=t("span.lower_value",this.elem),e.upper_display=t("span.upper_value",this.elem),e.lower_value=t("input.lower_value",this.elem),e.upper_value=t("input.upper_value",this.elem),this.options.values=[e.lower_value.val(),e.upper_value.val()]):(e.display=t("span.slider_value",this.elem),e.value=t("input.slider_value",this.elem),this.options.value=e.value.val(),this.value=this.options.value),this.elem.data("slider_elements",e),this.options.min=this.options.min??0,this.options.max=this.options.max??100}init_position(){this.vertical&&this.slider_elem.addClass("slider-vertical"),this.range_max&&(this.vertical?this.slider_value_track.css("bottom",0).css("top","unset"):this.slider_value_track.css("right",0))}resize_handle(){!0!==this.range&&(this.value_screen=this.transform(this.value,"display"),this.set_position(this.value_screen))}handle_singletouch(e){let t;t="mousedown"===e.type?this.vertical?e.pageY:e.pageX:this.vertical?e.touches[0].pageY:e.touches[0].pageX;let s=t-this.offset;this.handles[0].elem.css("left",s),this.slider_value_track.css("width",s)}set_values(){if(this.range_true){let e=this.handles[0].value,s=this.handles[1].value;t("span.lower_value",this.elem).text(e),t("input.lower_value",this.elem).attr("value",e),t("span.upper_value",this.elem).text(s),t("input.upper_value",this.elem).attr("value",s)}else{let e=this.handles[0].value;t("span.slider_value",this.elem).text(e),this.input.attr("value",e)}}}class i{constructor(e,s,i){this.slider=e,this.elem=t("<div></div>").addClass("slider-handle").width(20).height(20),this.slider.append(this.elem),this.value=i||s.value,this.min=s.min,this.max=s.max,this.step=s.step,this.value_screen=this.transform(this.value,"screen"),this.vertical="vertical"===s.orientation,this.dir=this.vertical?"top":"left",this.elem.css(`${this.dir}`,this.value_screen),this.slide_start=this.slide_start.bind(this),this.handle=this.handle_drag.bind(this),this.elem.on("mousedown touchstart",this.slide_start)}get slider_dim(){return this.vertical?this.slider.height():this.slider.width()}get value_screen(){return this._value_screen}set value_screen(e){e>=this.slider_dim?e=this.slider_dim:e<=0&&(e=0),this._value_screen=e}get offset(){return this.vertical?this.slider.offset().top:this.slider.offset().left}slide_start(e){e.preventDefault(),e.stopPropagation(),["mousemove","touchmove"].forEach((e=>document.addEventListener(e,this.handle,{passive:!1}))),["mouseup","touchend"].forEach((e=>document.addEventListener(e,(()=>{document.removeEventListener("touchmove",this.handle),document.removeEventListener("mousemove",this.handle)}),!1)))}handle_drag(e){console.log("handle drag"),e.preventDefault(),e.stopPropagation(),"mousemove"===e.type?this.value_screen=(this.vertical?e.pageY:e.pageX)-this.offset:this.value_screen=(this.vertical?e.touches[0].pageY:e.touches[0].pageX)-this.offset,this.value=this.transform(this.value_screen,"range"),this.step&&(this.value=this.transform(this.value,"step"),this.value_screen=this.transform(this.value,"screen")),this.elem.css(`${this.dir}`,this.value_screen+"px");const s=new t.Event("drag");this.slider.trigger(s)}transform(e,t){let s=this.min,i=this.max,l=this.step;if("step"===t){(e=e>(0===s?i-l/2:i-s/2)?i:l*parseInt(e/l))<=s&&(e=s)}else"screen"===t?e=parseInt(this.slider_dim*((e-s)/(i-s))):"range"===t&&(e=parseInt((i-s)*(e/this.slider_dim)+s));return e}}t((function(){void 0!==window.ts?ts.ajax.register(s.initialize,!0):s.initialize()})),e.SliderWidget=s,Object.defineProperty(e,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.slider=e}({},jQuery);
