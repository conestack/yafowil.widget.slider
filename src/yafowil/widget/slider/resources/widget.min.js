!function(e,s){"use strict";class t{static initialize(e){s(".yafowil_slider",e).each((function(){new t(s(this))}))}constructor(e){this.elem=e,this.options=this.elem.data(),this.min=this.options.min??0,this.max=this.options.max??100,this.step=this.options.step??1,this.slider_handle_dim=20,this.input=s("input.slider_value",this.elem),this.slider_elem=s("div.slider",this.elem),this.vertical="vertical"===this.options.orientation,this.dim=this.vertical?"height":"width",this.dir=this.vertical?"top":"left",this.slider_value_track=s("<div></div>").addClass("slider-value-track"),this.slider_elem.append(s("<div></div>").addClass("slider-bg")).append(this.slider_value_track),this.handles=[],this.range_true?(this.handles.push(new i(this,s("input.lower_value",this.elem),s("span.lower_value",this.elem))),this.handles.push(new i(this,s("input.upper_value",this.elem),s("span.upper_value",this.elem)))):this.handles.push(new i(this,s("input.slider_value",this.elem),s("span.slider_value",this.elem))),this.handle_singletouch=this.handle_singletouch.bind(this),this.slider_elem.on("mousedown touchstart",this.handle_singletouch),this.init_position(),this.set_value_track(),this.slider_elem.on("drag",this.set_value_track.bind(this)),s(window).on("resize",this.set_value_track.bind(this))}get range_max(){return"max"===this.options.range}get range_true(){return!0===this.options.range}get offset(){return this.vertical?this.slider_elem.offset().top:this.elem.offset().left}get slider_dim(){return this.vertical?this.slider_elem.height():this.elem.width()}set_value_track(e){let s=this.handles[0].pos;if(this.range_true){let e=this.handles[1].pos-this.handles[0].pos;this.slider_value_track.css(`${this.dim}`,e).css(`${this.dir}`,`${s}px`)}else this.range_max?this.slider_value_track.css(`${this.dim}`,this.slider_dim-s):this.slider_value_track.css(`${this.dim}`,s)}init_position(){this.vertical&&this.slider_elem.addClass("slider-vertical"),this.range_max&&(this.vertical?this.slider_value_track.css("bottom",0).css("top","unset"):this.slider_value_track.css("right",0))}handle_singletouch(e){let s,t;if(s="mousedown"===e.type?(this.vertical?e.pageY:e.pageX)-this.offset:(this.vertical?e.touches[0].pageY:e.touches[0].pageX)-this.offset,this.range_true){let e=[this.handles[0].pos,this.handles[1].pos];t=s<e[0]||s<(e[0]+e[1])/2?this.handles[0]:this.handles[1]}else t=this.handles[0];t.pos=s,t.value=t.transform(s,"range"),this.set_value_track()}}class i{constructor(e,t,i){this.slider=e,this.elem=s("<div></div>").addClass("slider-handle").width(20).height(20),this.slider.slider_elem.append(this.elem),this.input_elem=t,this.span_elem=i,this.value=this.input_elem.val(),this.pos=this.transform(this.value,"screen"),this.vertical=this.slider.vertical,this.elem.css(`${this.slider.dir}`,this.pos),this.slide_start=this.slide_start.bind(this),this.handle_drag=this.handle_drag.bind(this),this.elem.on("mousedown touchstart",this.slide_start),s(window).on("resize",this.resize.bind(this))}get offset(){return this.slider.offset}get value(){return this._value}set value(e){this.input_elem.attr("value",e),this.span_elem.text(e),this._value=e}get pos(){return this._pos}set pos(e){e>=this.slider.slider_dim?e=this.slider.slider_dim:e<=0&&(e=0),this.elem.css(`${this.slider.dir}`,`${e}px`),this._pos=e}resize(){this.pos=this.transform(this.value,"screen")}slide_start(e){e.preventDefault(),e.stopPropagation(),["mousemove","touchmove"].forEach((e=>document.addEventListener(e,this.handle_drag,{passive:!1}))),["mouseup","touchend"].forEach((e=>document.addEventListener(e,(()=>{document.removeEventListener("touchmove",this.handle_drag),document.removeEventListener("mousemove",this.handle_drag)}),!1)))}handle_drag(e){let t;if(e.preventDefault(),e.stopPropagation(),t="mousemove"===e.type?(this.vertical?e.pageY:e.pageX)-this.offset:(this.vertical?e.touches[0].pageY:e.touches[0].pageX)-this.offset,!0===this.slider.options.range){let e=this.slider.handles[0],s=this.slider.handles[1];if(this===e&&t>=s.pos||this===s&&t<=e.pos)return}this.pos=t,this.value=this.transform(this.pos,"range"),this.slider.step&&(this.value=this.transform(this.value,"step"),this.pos=this.transform(this.value,"screen"));const i=new s.Event("drag");this.slider.slider_elem.trigger(i)}transform(e,s){let t=this.slider.min,i=this.slider.max,h=this.slider.step;if("step"===s){e=(e=e>(0===t?i-h/2:i-t/2)?i:h*parseInt(e/h))<=t?t:e}else"screen"===s?e=parseInt(this.slider.slider_dim*((e-t)/(i-t))):"range"===s&&(e=parseInt((i-t)*(e/this.slider.slider_dim)+t));return e}}s((function(){void 0!==window.ts?ts.ajax.register(t.initialize,!0):t.initialize()})),e.SliderWidget=t,Object.defineProperty(e,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.slider=e}({},jQuery);
