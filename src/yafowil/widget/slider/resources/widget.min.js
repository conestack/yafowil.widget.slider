!function(e,t){"use strict";class s{static initialize(e){t(".yafowil_slider",e).each((function(){new s(t(this))}))}constructor(e){this.elem=e,this.options=this.elem.data(),this.bind_options();this.supports_touch="ontouchstart"in window||navigator.msMaxTouchPoints,this.slider_handle_dim=this.supports_touch?30:20,this.input=t("input.slider_value",this.elem),this.slider_elem=t("div.slider",this.elem);let s=this.slider_handle_elem=t(`\n            <div class="slider-handle" \n                 style="width:${this.slider_handle_dim}px;\n                        height:${this.slider_handle_dim}px"/>\n        `),i=this.slider_value_track=t('\n            <div class="slider-value-track" />\n        '),n=t('\n            <div class="slider-bg" />\n        ');if(this.slider_elem.append(n).append(i).append(s),this.handle_mousedown=this.handle_mousedown.bind(this),this.handle_touch=this.handle_touch.bind(this),this.handle_drag=this.handle_drag.bind(this),this.handle_touch_range=this.handle_touch_range.bind(this),this.handle_singletouch=this.handle_singletouch.bind(this),!0===this.options.range){let e=this.slider_handle_elem_end=t(`\n                <div class="slider-handle-end"\n                     style="width:${this.slider_handle_dim}px;\n                            height:${this.slider_handle_dim}px"/>\n            `);this.slider_elem.append(e),this.handle_drag_range=this.handle_drag_range.bind(this),this.slider_handle_elem.on("mousedown",this.handle_drag_range),this.slider_handle_elem_end.on("mousedown",this.handle_drag_range),this.supports_touch&&(this.slider_handle_elem[0].addEventListener("touchstart",this.handle_touch_range,!1),this.slider_handle_elem_end[0].addEventListener("touchstart",this.handle_touch_range,!1))}else this.slider_handle_elem.off("mousedown").on("mousedown",this.handle_mousedown),this.slider_elem.on("click",this.handle_singletouch),this.supports_touch&&(this.slider_handle_elem[0].addEventListener("touchstart",this.handle_touch,!1),this.slider_elem[0].addEventListener("touchstart",this.handle_singletouch,!1));this.init_position()}bind_options(){let e={};!0===this.options.range?(e.lower_display=t("span.lower_value",this.elem),e.upper_display=t("span.upper_value",this.elem),e.lower_value=t("input.lower_value",this.elem),e.upper_value=t("input.upper_value",this.elem),this.options.values=[e.lower_value.val(),e.upper_value.val()]):(e.display=t("span.slider_value",this.elem),e.value=t("input.slider_value",this.elem),this.options.value=e.value.val()),this.elem.data("slider_elements",e)}init_position(){let e=this.options;if(e.min=e.min??0,e.max=e.max??100,"vertical"===e.orientation?(this.slider_elem.addClass("slider-vertical"),this.slider_dim=this.slider_elem.height(),this.offset=this.slider_elem.offset().top):(this.slider_dim=this.elem.width(),this.offset=this.elem.offset().left),!0===e.range){let t=[this.transform(e.values[0],"display"),this.transform(e.values[1],"display")];this.set_position(t)}else if(e.value){let t=this.transform(e.value,"display");this.set_position(t)}"max"===e.range&&("vertical"===e.orientation?this.slider_value_track.css("bottom",0).css("top","unset"):this.slider_value_track.css("right",0)),this.supports_touch&&this.elem.addClass("touch-support")}handle_singletouch(e){let s=("vertical"===this.options.orientation?e.pageY:e.pageX)-this.offset,i=this.transform(s,"range");this.options.step&&(i=this.transform(i,"step"),s=this.transform(i,"display")),this.set_position(s),t("span.slider_value",this.elem).text(i)}handle_mousedown(e){e.preventDefault(),this.elem.off("mousemove").on("mousemove",this.handle_drag)}handle_touch(){let e=function(s){s.preventDefault(),s.stopPropagation();let i="vertical"===this.options.orientation?s.touches[0].pageY:s.touches[0].pageX,n=this.prevent_overflow(i-this.offset),l=this.transform(n,"range");this.options.step&&(l=this.transform(l,"step"),n=this.transform(l,"display"));this.set_position(n),t("span.slider_value",this.elem).text(l),document.addEventListener("touchend",function(){document.removeEventListener("touchmove",e)}.bind(this),!1)}.bind(this);document.addEventListener("touchmove",e,{passive:!1})}handle_touch_range(e){let s=e.target,i=function(e){e.preventDefault(),e.stopPropagation();let i=n?e.touches[0].pageY:e.touches[0].pageX,o=n?"top":"left",h=[parseInt(l[0].css(o)),parseInt(l[1].css(o))],a=parseInt(this.prevent_overflow(i-this.offset)),r=this.transform(a,"range");if(s===l[0][0]){if(touch_pos-this.offset>h[1]-this.slider_handle_dim+10)return;h[0]=a,t(".lower_value").text(r)}else if(s===l[1][0]){if(touch_pos-this.offset<h[0]+this.slider_handle_dim-10)return;h[1]=a,t(".upper_value").text(r)}this.set_position(h)}.bind(this),n="vertical"===this.options.orientation,l=[this.slider_handle_elem,this.slider_handle_elem_end];document.addEventListener("touchmove",i,{passive:!1}),document.addEventListener("touchend",function(){document.removeEventListener("touchmove",i)}.bind(this),!1)}handle_drag(e){e.preventDefault(),e.stopPropagation();let s="vertical"===this.options.orientation,i=this.options.step,n=(s?e.pageY:e.pageX)-this.offset,l=this.prevent_overflow(n),o=this.transform(l,"range");i&&(o=this.transform(o,"step"),l=this.transform(o,"display")),this.set_position(l),t("span.slider_value",this.elem).text(o),t(window).on("mouseup",(()=>{this.elem.off("mousemove")}))}handle_drag_range(e){e.preventDefault(),e.stopPropagation();let s=e.target,i="vertical"===this.options.orientation,n=[this.slider_handle_elem,this.slider_handle_elem_end];t(this.elem).off("mousemove").on("mousemove",(e=>{e.preventDefault(),e.stopPropagation();let l=i?e.pageY:e.pageX,o=this.prevent_overflow(l-this.offset),h=this.transform(o,"range"),a=i?"top":"left",r=[parseInt(n[0].css(a)),parseInt(n[1].css(a))];if(s===n[0][0]){if(o>r[1]-this.slider_handle_dim)return;r[0]=o,t(".lower_value").text(h)}else if(s===n[1][0]){if(o<r[0]+this.slider_handle_dim)return;r[1]=o,t(".upper_value").text(h)}this.set_position(r)})),t(window).on("mouseup",(()=>{this.elem.off("mousemove")}))}prevent_overflow(e){return e>=this.slider_dim?e=this.slider_dim:e<=0&&(e=0),e}set_position(e){let t="vertical"===this.options.orientation,s=this.options.range,i=this.slider_value_track,n=this.slider_handle_elem,l=this.slider_handle_elem_end;if(t)if("max"===s)i.css("height",this.slider_dim-e),n.css("top",e+"px");else if(!0===s){n.css("top",e[0]),l.css("top",e[1]);let t=e[1]-e[0];i.css("height",t).css("top",`${e[0]}px`)}else i.css("height",e),n.css("top",e+"px");else if("max"===s)i.css("width",this.slider_dim-e),n.css("left",e+"px");else if(!0===s){n.css("left",e[0]),l.css("left",e[1]);let t=e[1]-e[0];i.css("width",t).css("left",`${e[0]}px`)}else i.css("width",e),n.css("left",e+"px")}transform(e,t){let s=this.options.min,i=this.options.max,n=this.options.step;return"step"===t?e=e>i-n/2?i:n*parseInt(e/n):"display"===t?e=parseInt(this.slider_dim*((e-s)/(i-s))):"range"===t&&(e=parseInt((i-s)*(e/this.slider_dim)+s)),e}}t((function(){void 0!==window.ts?ts.ajax.register(s.initialize,!0):s.initialize()})),e.Slider=s,Object.defineProperty(e,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.slider=e}({},jQuery);
