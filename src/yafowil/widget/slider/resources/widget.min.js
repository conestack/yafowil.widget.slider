!function(e,t){"use strict";class s{static initialize(e){t(".yafowil_slider",e).each((function(){new s(t(this))}))}constructor(e){this.elem=e,this.options=this.elem.data(),this.init_options();let s=this.slider_handle_dim=20;this.input=t("input.slider_value",this.elem),this.slider_elem=t("div.slider",this.elem),this.handle_elem=t("<div></div>").addClass("slider-handle").width(s).height(s),this.slider_value_track=t("<div></div>").addClass("slider-value-track"),this.slider_elem.append(t("<div></div>").addClass("slider-bg")).append(this.slider_value_track).append(this.handle_elem),this.handle_singletouch=this.handle_singletouch.bind(this),this.handle_start=this.slide_start.bind(this),this.handle_range=this.handle_range.bind(this),this.range_true?(this.handle_elem_end=t("<div></div>").addClass("slider-handle-end").width(s).height(s),this.slider_elem.append(this.handle_elem_end),this.handle_elem.on("mousedown touchstart",this.handle_range),this.handle_elem_end.on("mousedown touchstart",this.handle_range),this.slider_elem.on("mousedown touchstart",this.handle_singletouch)):(this.handle_elem.on("mousedown touchstart",this.handle_start),this.slider_elem.on("mousedown touchstart",this.handle_singletouch)),this.init_position()}get vertical(){return"vertical"===this.options.orientation}get range_max(){return"max"===this.options.range}get range_true(){return!0===this.options.range}get step(){return this.options.step}init_options(){let e={};this.range_true?(e.lower_display=t("span.lower_value",this.elem),e.upper_display=t("span.upper_value",this.elem),e.lower_value=t("input.lower_value",this.elem),e.upper_value=t("input.upper_value",this.elem),this.options.values=[e.lower_value.val(),e.upper_value.val()]):(e.display=t("span.slider_value",this.elem),e.value=t("input.slider_value",this.elem),this.options.value=e.value.val()),this.elem.data("slider_elements",e)}init_position(){let e=this.options;if(e.min=e.min??0,e.max=e.max??100,this.vertical?(this.slider_elem.addClass("slider-vertical"),this.slider_dim=this.slider_elem.height(),this.offset=this.slider_elem.offset().top):(this.slider_dim=this.elem.width(),this.offset=this.elem.offset().left),this.range_true){let t=[this.transform(e.values[0],"display"),this.transform(e.values[1],"display")];this.set_position(t)}else if(e.value){let t=this.transform(e.value,"display");this.set_position(t)}this.range_max&&(this.vertical?this.slider_value_track.css("bottom",0).css("top","unset"):this.slider_value_track.css("right",0))}handle_singletouch(e){let t;t="mousedown"===e.type?this.vertical?e.pageY:e.pageX:this.vertical?e.touches[0].pageY:e.touches[0].pageX;let s=t-this.offset,i=this.transform(s,"range");if(this.step&&(i=this.transform(i,"step"),s=this.transform(i,"display")),this.range_true){let e=this.vertical?"top":"left",t=[parseInt(this.handle_elem.css(e)),parseInt(this.handle_elem_end.css(e))],l=s<t[0]||s<(t[0]+t[1])/2,a=l?".lower_value":".upper_value";t=l?[s,t[1]]:[t[0],s],this.set_position(t),this.set_values(i,a)}else this.set_position(s),this.set_values(i)}slide_start(e){e.preventDefault(),e.stopPropagation();let t=this.handle_drag.bind(this);["mousemove","touchmove"].forEach((e=>document.addEventListener(e,t,{passive:!1}))),["mouseup","touchend"].forEach((e=>document.addEventListener(e,(()=>{document.removeEventListener("touchmove",t),document.removeEventListener("mousemove",t)}),!1)))}handle_drag(e){let t;e.preventDefault(),e.stopPropagation(),t="mousemove"===e.type?(this.vertical?e.pageY:e.pageX)-this.offset:(this.vertical?e.touches[0].pageY:e.touches[0].pageX)-this.offset;let s=this.prevent_overflow(t),i=this.transform(s,"range");this.step&&(i=this.transform(i,"step"),s=this.transform(i,"display")),this.set_position(s),this.set_values(i)}handle_range(e){e.preventDefault(),e.stopPropagation();let t=e.target,s=this.vertical?"top":"left",i=[this.handle_elem,this.handle_elem_end],l=function(e){let l;e.preventDefault(),e.stopPropagation(),l="mousemove"===e.type?this.vertical?e.pageY:e.pageX:this.vertical?e.touches[0].pageY:e.touches[0].pageX;l=this.prevent_overflow(l-this.offset);let a=this.transform(l,"range"),n=[parseInt(i[0].css(s)),parseInt(i[1].css(s))];if(t===i[0][0]){if(l>=n[1])return;n[0]=l,this.set_values(a,".lower_value")}else if(t===i[1][0]){if(l<=n[0])return;n[1]=l,this.set_values(a,".upper_value")}this.set_position(n)}.bind(this);["mousemove","touchmove"].forEach((e=>document.addEventListener(e,l,{passive:!1}))),["mouseup","touchend"].forEach((e=>document.addEventListener(e,(()=>{document.removeEventListener("touchmove",l),document.removeEventListener("mousemove",l)}),!1)))}prevent_overflow(e){return e>=this.slider_dim?e=this.slider_dim:e<=0&&(e=0),e}set_position(e){let t=this.slider_value_track,s=this.handle_elem,i=this.handle_elem_end;if(this.vertical)if(this.range_max)t.css("height",this.slider_dim-e),s.css("top",e+"px");else if(this.range_true){s.css("top",e[0]),i.css("top",e[1]);let l=e[1]-e[0];t.css("height",l).css("top",`${e[0]}px`)}else t.css("height",e),s.css("top",e+"px");else if(this.range_max)t.css("width",this.slider_dim-e),s.css("left",e+"px");else if(this.range_true){s.css("left",e[0]),i.css("left",e[1]);let l=e[1]-e[0];t.css("width",l).css("left",`${e[0]}px`)}else t.css("width",e),s.css("left",e+"px")}set_values(e,s){this.range_true?(t(`span${s}`).text(e),t(`input${s}`).attr("value",e)):(t("span.slider_value",this.elem).text(e),this.input.attr("value",e))}transform(e,t){let s=this.options.min,i=this.options.max,l=this.options.step;return"step"===t?e=e>i-l/2?i:l*parseInt(e/l):"display"===t?e=parseInt(this.slider_dim*((e-s)/(i-s))):"range"===t&&(e=parseInt((i-s)*(e/this.slider_dim)+s)),e}}t((function(){void 0!==window.ts?ts.ajax.register(s.initialize,!0):s.initialize()})),e.Slider=s,Object.defineProperty(e,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.slider=e}({},jQuery);
